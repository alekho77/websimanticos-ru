<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta name="author" content="Alexey U. Khozin" />
    <meta name="copyright" content="(c) Alexey U. Khozin 2019" />
    <meta name="resource-type" content="document" />
    <meta name="document-state" content="dynamic" />
    <meta name="rating" content="General" />
    <meta name="distribution" content="Global" />
    <meta name="robots" content="index, follow" />
    <meta http-equiv="content-language" content="ru" />
    <meta name="description" content="Проект по сематическому анализу русскоязычного сегмента интернета">
    <meta name="keywords" content="word embeddings искусственные нейронные сети сематический анализ word2vec алгоритм">
    <link rel="shortcut icon" href="/images/small-logo.png" type="image/png">
    <title>RU web семантика</title>
    <style type="text/css">
      p {
        font-family: Georgia, 'Times New Roman', Times, serif;
        font-size: 12pt;
        padding-left: 5%;
        padding-right: 5%;
        text-align: justify;
        line-height: 150%;
      }
      .banner {
        display: block;
        background-color: black;
        text-align: center;
      }
      .text {
        display: block;
      }
      .border {
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 80%;
        padding-top: 20px;
        padding-bottom: 20px;
      }
      .loading {
        color: darkgray;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 9pt;
        text-align: right;
        padding-right: 9pt; 
        top: -9pt;
        position: relative
      }
      img.sphere {
        width: 100%;
        max-width: 1086px;
        height: auto;
      }
      a:link {
        text-decoration: none;
      }
      a:visited {
        text-decoration: none;
      }
      a:hover {
        text-decoration: underline;
      }
      a:active {
        text-decoration: underline;
      }
    </style>
  </head>
  <body style="background-color: white">
    <div style="width: 90%; max-width: 1280px; margin-left: auto; margin-right: auto; display: block; background-color: linen">
      <div class="banner">
        <div class="border">
          <img src="/images/logo.png" alt="" style="display: inline; vertical-align: middle" />
          <div style="display: inline">
            <h1 style="color: deepskyblue; font-family: monospace; margin-left: 5%; display: inline">
              <span style="vertical-align: top">web</span>
              <span style="vertical-align: bottom; font-size: 300%; font-weight: bold; font-style: italic">RU</span>
              <span style="vertical-align: middle; font-size: 200%">семантика</span>
            </h1>
            <h2 style="color: royalblue; display: inline; vertical-align: bottom; margin-left: -5ch">σημαντικός</h2>
          </div>
        </div>
      </div>
      <div class="text">
        <p>
          <img src="/images/words-math.svg" alt="" style="float: right; width: auto; height: 220px; padding: 6pt; margin-top: 6pt; margin-left: 12pt; border: solid 1px gray; background-color: snow">
          Проект по сематическому анализу русскоязычного сегмента интернета на основе моделей word embeddings,
          построенных и обученных на искусственных нейронных сетях командой Андрея Кутузова (<a target="_blank" href="https://rusvectores.org">проект RusVectōrēs</a>),
          которые позволили получить уже готовые модели для вычисления семантических отношений между словами русского языка.
          Сегодня алгоритмы word embeddings, которые сопоставляют вектор слову, уже достаточно хорошо известны и с успехом применяются лидерами интернета.
          Взлет популярности этих алгоритмов начался в 2013 году, когда еще мало кому известный чешский аспирант Томаш Миколов предложил свой подход к word embedding,
          который он назвал word2vec. Его подход основан важной гипотезе,
          которую в науке принято называть гипотезой локальности — «слова, которые встречаются в одинаковых окружениях, имеют близкие значения».
          Кому интересно, можно более подробно прочитать интервью с Томасом Миколов: <a target="_blank" href="https://rb.ru/interview/tomas-mikolov/">До восстания машин еще далеко</a>.
        </p>
        <p>
          Для данного проекта вручную были отобраны два с половиной десятка тем:
          'Компьютеры', 'Софт', 'Игры', 'Кино', 'Музыка и MP3', 'Интернет', 'Новости, СМИ', 'Товары, услуги', 'Авто', 'Города и регионы',
          'Недвижимость', 'Погода', 'Спорт', 'Медицина и здоровье', 'Наука', 'Литература', 'Работа', 'Обучение', 'Экономика и бизнес',
          'Путешествия', 'Дом и семья', 'Юмор', 'Развлечения', 'Знакомства, общение'. Их семантическая близость упрощенно показана на следующем рисунке.
        </p>
      </div>
      <div class="banner">
        <img src="/images/websematicsky-topics.png" alt="Расположение основных тем на смысловой сфере" class="sphere" />
      </div>
      <div class="text">
        <p>
            Важно отметить, что изначально размерность «смыслового пространства» очень велика.
            Обычно она составляет несколько сотен измерений. Поэтому для удобного человеку представления, данные были «сжаты» до 3-х измерений.
            А так как семантическая близость в машинном представлении вычисляется через угол между векторами в "смысловом пространстве",
            то для представления некоторого слова или нескольких слов, или даже целого текста,
            удобно выражать эти сжатые до 3-х измерений вектора через их сферические координаты на некоторой «смысловой сфере», развёртку которой вы можете видеть ни рисунках.
        </p>
        <p>
            При таком представлении теряется очень много важных сематических аспектов,
            но общую картину, которая была бы интуитивно понятна человеку, хорошо заметна на рисунках.
            Отчетливо видены группы с близкими темами, такими как «музыка, кино и игры» и «компьютеры и софт».
            Эти группы через «интернет» и «новости» соединяются с большой группой «товаров и услуг, недвижимости, автомобилей, городов и регионов».
            Есть группа, отвечающая за смысловое пространство «развлечений, юмора, знакомств и общения, путешествий»,
            а также группа близких к другу понятий, таких как «обучение, работа, экономика и бизнес».
            Есть также ряд понятий, стоящих обособленно, это «погода», «дом и семья».
            В стороне, но чуть более тесно, располагаются такие понятия как «спорт», «здоровье и медицина», «наука» и «литература».
            Группы, далёкие друг от друга по смыслу, располагаются в разных полушариях «смысловой сферы».
        </p>
        <p>
            Ниже представлен рисунок, на котором небольшими точками показаны несколько сотен тысяч слов русского языка,
            окрашенных в цвет той темы, с которой они наиболее близки. Эти слова были получены при обучении алгоритма word2vec на нескольких тысячах русскоязычных сайтов.
        </p>
      </div>
      <div class="banner">
        <img src="/images/websematicsky-words.png" alt="300 тысяч русских слов разбросанных по смыслу" style="cursor: crosshair" class="sphere"
          onmouseover="showImgHint('imghint')" onmouseout="hideImgHint('imghint')" onmousemove="cursorMove('imghint', event, this)" />
        <div class="loading">
          <span id="loadWordsTxt">Загрузка слов</span>
          <img id="loadWordsImg" src="/images/255.gif" alt="" style="vertical-align: middle">
        </div>
      </div>
      <div class="text">
        <p>
          Здесь отчетливо виден «жаркий материк» игр, музыки и кино, на котором разместились также слова, связанные с компьютерами и программным обеспечением.
          В северном полушарии от этого «материка» разливается «море» развлечений, общения, юмора и путешествий.
          В юго-восточной части «смысловой сферы» расположился «холодный материк» с работой, обучением, бизнесом, здравоохранением, наукой и литературой.
          Не далеко от него, но уже в северо-западной части, располагается «зеленый океан» с городов, новостей, товаров и услуг.
        </p>
        <p>
          Вы можете самостоятельно подвигать курсором мыши над сематической картой русских слов и посмотреть в каждой точке несколько слов наиболее близких по смыслу.
        </p>
        <p>
          Работы продолжаются, и следующим шагом будет визуализация нескольких тысяч наиболее популярных русскоязычных сайтов в соответствие с их смысловым наполнением…
        </p>
      </div>
      <div class="banner">
          <div class="border" style="font-family: Verdana, Geneva, Tahoma, sans-serif">
            <div style="color: goldenrod; font-size: 8pt; margin-top: 10px; margin-bottom: 10px">
              <span>&copy; Copyright</span>
              <a style="color: goldenrod" href="mailto:mail@websimanticos.ru">Alexey Khozin</a> 
              <span>2019</span>
            </div>
            <div style="color: gray; margin-top: 10px; margin-bottom: 10px; font-size: 60%">
                <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>
                <br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/" style="color: gray">Creative Commons Attribution 4.0 International License</a>.
            </div>
            <div>
<!--LiveInternet counter--><script type="text/javascript">
document.write("<a href='//www.liveinternet.ru/click' "+
"target=_blank><img src='//counter.yadro.ru/hit?t52.4;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,150))+";"+Math.random()+
"' alt='' title='LiveInternet: number of pageviews and visitors"+
" for 24 hours is shown' "+
"border='0' width='88' height='31'><\/a>")
</script><!--/LiveInternet-->              
            </div>
          </div>
      </div>
    </div>
    <div id="imghint" style="display: inline-block; position: absolute; z-index: 1; opacity: 0; background-color: snow; margin-left: 5px; margin-top: 5px; padding: 2px; font-family: Arial, Helvetica, sans-serif; font-size: 8pt; font-weight: bold"></div>
  </body>
  <script>
    function showImgHint(id) {
      document.getElementById(id).style.opacity = 1;
    }
    function hideImgHint(id) {
      document.getElementById(id).style.opacity = 0;
    }
    function invertHammer(x, y) {
      x2 = x * x;
      y2 = y * y;
      z = 1.0 - x2 / 16.0 - y2 / 4.0;
      if (z >= 0.0) {
        z = Math.sqrt(z);
        phi = Math.asin(z * y);
        theta = 2 * Math.atan2(z * x, 2 * (2 * z * z - 1));
        if (Math.abs(theta) <= Math.PI) {
          return {phi:phi, theta:theta};
        }
      }
      return null;
    }
    function norm(v) {
      n = 0.0;
      for (i = 0; i < v.length; i++) {
        n += v[i] * v[i];
      }
      return Math.sqrt(n);
    }
    function similarity(a, b) {
      dot = 0.0;
      for (i = 0; i < a.length; i++) {
        dot += a[i] * b[i];
      }
      return dot / (norm(a) * norm(b));
    }
    function most_similar(vocab, vec, topn=1) {
      toplist = new Array(topn);
      for (w = 0; w < vocab.length; w++) {
        s = similarity(vocab[w][1], vec);
        for (i = 0; i < toplist.length; i++) {
          if ((typeof toplist[i] === 'undefined') || (toplist[i].sim < s)) {
            toplist[i] = {word: vocab[w][0], sim: s};
            break;
          }
        }
      }
      return toplist;
    }
    function cursorMove(id, event, img) {
      elem = document.getElementById(id);
      s = img.width / 1086.0;
      w2 = 475.0 * s;
      h2 = img.height / 2.0;
      coords = invertHammer((event.offsetX - w2) / w2 * 3.0055992936340946227328954988797, - (event.offsetY - h2) / h2 * 1.5720498974593779783554486264652);
      if (coords) {
        geostr = "φ: " + (coords.phi * 180 / Math.PI) + ", θ: " + (coords.theta * 180 / Math.PI);
        vec = [Math.cos(coords.phi) * Math.cos(coords.theta), Math.cos(coords.phi) * Math.sin(coords.theta), Math.sin(coords.phi)];
        toplist = most_similar(words3dvec, vec, 5);
        str = '';
        for (i = 0; i < toplist.length; i++) {
          if (typeof toplist[i] === 'undefined') break;
          str += '<tr><td>' + toplist[i].word /* + '</td><td>' + toplist[i].sim*/ + '</td></tr>';
        }
        elem.innerHTML = (str.length > 0) ? '<table>' + str + '</table>' : geostr;
      } else {
        elem.innerHTML = "пусто";
      }
      elem.style.left = event.pageX + "px";
      elem.style.top =  event.pageY + "px";
    }
    function createAJAX() {
      var ajax = {
        xmlHttp: false,
        enabled: false,
        timeout: 60000,
        timer: null,
        handlerLoad: null, //function(url) { alert('Loading...\r\n' + url); },
        handlerResponse: null, //function(resp) { alert('OK\r\n' + resp); },
        handlerError: null, //function(status, text) { alert('Error: ' + status + '\r\n' + text); },
        handlerTimer: null, //function() { gajax.xmlHttp.abort(); gajax.timer = null; if (gajax.handlerError) gajax.handlerError('', 'Timeout!'); },
        handlerState: function() {
            if (gajax.xmlHttp.readyState == 4) {
              if (gajax.timer) { clearTimeout(gajax.timer); gajax.timer = null; }
              if (gajax.xmlHttp.status == 200) {
                if (gajax.handlerResponse) gajax.handlerResponse(gajax.xmlHttp.responseText);
              } else {
                if (gajax.handlerError) gajax.handlerError(gajax.xmlHttp.status, gajax.xmlHttp.statusText);
              }
            }
          },
        init: function() {
            /*@cc_on@*/
            /*@if (@_jscript_version >= 5)
            try { this.xmlHttp = new ActiveXObject("Msxml2.XMLHTTP"); }
            catch (e) {
                try { this.xmlHttp = new ActiveXObject("Microsoft.XMLHTTP"); }
                catch (e2) { this.xmlHttp = false; }
            }
            @end@*/
            if (!this.xmlHttp && typeof XMLHttpRequest != 'undefined') this.xmlHttp = new XMLHttpRequest();
            if (this.xmlHttp) this.enabled = true;
          },
        get: function(url) {
            this.xmlHttp.abort();
            this.xmlHttp.open('GET', url, true);
            this.xmlHttp.onreadystatechange = this.handlerState;
            if (this.handlerTimer) this.timer = setTimeout(this.handlerTimer, this.timeout);
            this.xmlHttp.send(null);
            if (this.handlerLoad) this.handlerLoad(url);
          },
        postdata: function(url, params) {
            this.xmlHttp.abort();
            if(this.timer) clearTimeout(this.timer);
            this.xmlHttp.open('POST', url, true);
            this.xmlHttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            this.xmlHttp.onreadystatechange = this.handlerState;
            if (this.handlerTimer) this.timer = setTimeout(this.handlerTimer, this.timeout);
            this.xmlHttp.send(params);
            if (this.handlerLoad) this.handlerLoad(url);
          }
      };
      ajax.init();
      if (ajax && ajax.enabled) return ajax;
      return null;
    }
    //=================================================================================================================
    words3dvec = [];
    words3dvec_count = 0;
    var gajax = createAJAX();
    if(gajax) {
      gajax.handlerResponse = function(resp) {
        finished = true;
        try {
          words = JSON.parse(resp);
          if (words instanceof Array) {
            if (words.length > 0) {
              words3dvec = words3dvec.concat(words);
              words3dvec_count++;
              finished = false;
            }
          }
        } finally {
          document.getElementById('loadWordsTxt').innerHTML = 'Загружено ' + words3dvec.length + ' слов';
          if (finished) {
            document.getElementById('loadWordsImg').style.display = 'none';
          } else {
            gajax.postdata('/words.php', 'count=' + words3dvec_count);
          }
        }
      };
      gajax.postdata('/words.php', 'count=' + words3dvec_count);
    }
  </script>
</html>
